Using device: cuda
Model parameters: 831,728
{'items': array([472,  97, 122, 654, 709, 467, 574, 544, 478, 338, 301, 185, 156,
       712, 525, 225, 396, 370, 589, 750, 586, 353, 416, 687, 465, 433,
       215, 438, 219, 528, 134, 444,  92,  24, 145, 572,  22, 454, 715,
       364,  19, 115, 386, 374, 203, 229,  44, 624, 303, 152, 206, 268,
       329, 692,   8,  12, 291, 633, 537, 457, 121, 689, 164, 114, 566,
       519, 234, 154, 104,  74,  49,  86, 419, 315, 387, 663, 400]), 'ratings': array([4., 3., 4., 3., 5., 4., 2., 1., 4., 5., 5., 3., 4., 4., 4., 2., 5.,
       5., 5., 4., 4., 3., 4., 5., 1., 1., 5., 4., 4., 4., 4., 4., 4., 5.,
       2., 4., 5., 3., 4., 3., 2., 1., 5., 3., 4., 4., 3., 5., 4., 5., 4.,
       5., 4., 3., 4., 4., 5., 5., 3., 2., 4., 5., 5., 5., 2., 5., 5., 2.,
       4., 5., 4., 5., 4., 5., 4., 3., 5.]), 'returns_to_go': array([296., 292., 289., 285., 282., 277., 273., 271., 270., 266., 261.,
       256., 253., 249., 245., 241., 239., 234., 229., 224., 220., 216.,
       213., 209., 204., 203., 202., 197., 193., 189., 185., 181., 177.,
       173., 168., 166., 162., 157., 154., 150., 147., 145., 144., 139.,
       136., 132., 128., 125., 120., 116., 111., 107., 102.,  98.,  95.,
        91.,  87.,  82.,  77.,  74.,  72.,  68.,  63.,  58.,  53.,  51.,
        46.,  41.,  39.,  35.,  30.,  26.,  21.,  17.,  12.,   8.,   5.]), 'timesteps': array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16,
       17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33,
       34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50,
       51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67,
       68, 69, 70, 71, 72, 73, 74, 75, 76], dtype=int32), 'user_group': 0}
Number of training trajectories: 16000
<dataset_reference.RecommendationDatasetReference object at 0x7fa1fd754c50>

Dataset details:
Dataset train size: 14400
Batches per epoch (train): 225
Dataset val size: 1600
Batches per epoch (val): 25
  ✔ Checkpoint guardado: checkpoints/dt_epoch1_val6.6249.pt
Epoch 1/2000
  Train Loss: 6.6337
  Val   Loss: 6.6249
  ✔ Checkpoint guardado: checkpoints/dt_epoch11_val6.6236.pt
Epoch 11/2000
  Train Loss: 6.6237
  Val   Loss: 6.6236
  ✔ Checkpoint guardado: checkpoints/dt_epoch21_val6.6233.pt
Epoch 21/2000
  Train Loss: 6.6232
  Val   Loss: 6.6233
  ✔ Checkpoint guardado: checkpoints/dt_epoch31_val6.6230.pt
Epoch 31/2000
  Train Loss: 6.6228
  Val   Loss: 6.6230
  ✔ Checkpoint guardado: checkpoints/dt_epoch41_val6.6228.pt
Epoch 41/2000
  Train Loss: 6.6225
  Val   Loss: 6.6228
Epoch 51/2000
  Train Loss: 6.6225
  Val   Loss: 6.6230
Epoch 61/2000
  Train Loss: 6.6225
  Val   Loss: 6.6229
Epoch 71/2000
  Train Loss: 6.6224
  Val   Loss: 6.6229
Epoch 81/2000
  Train Loss: 6.6224
  Val   Loss: 6.6228
Epoch 91/2000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 101/2000
  Train Loss: 6.6224
  Val   Loss: 6.6230
  ✔ Checkpoint guardado: checkpoints/dt_epoch111_val6.6227.pt
Epoch 111/2000
  Train Loss: 6.6224
  Val   Loss: 6.6227
Epoch 121/2000
  Train Loss: 6.6223
  Val   Loss: 6.6232
Epoch 131/2000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 141/2000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 151/2000
  Train Loss: 6.6224
  Val   Loss: 6.6229
Epoch 161/2000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 171/2000
  Train Loss: 6.6223
  Val   Loss: 6.6230
Epoch 181/2000
  Train Loss: 6.6224
  Val   Loss: 6.6229
Epoch 191/2000
  Train Loss: 6.6224
  Val   Loss: 6.6232
Epoch 201/2000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 211/2000
  Train Loss: 6.6224
  Val   Loss: 6.6228
  ✔ Checkpoint guardado: checkpoints/dt_epoch221_val6.6227.pt
Epoch 221/2000
  Train Loss: 6.6224
  Val   Loss: 6.6227
Epoch 231/2000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 241/2000
  Train Loss: 6.6225
  Val   Loss: 6.6229
Epoch 251/2000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 261/2000
  Train Loss: 6.6224
  Val   Loss: 6.6232
Epoch 271/2000
  Train Loss: 6.6224
  Val   Loss: 6.6232
Epoch 281/2000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 291/2000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 301/2000
  Train Loss: 6.6223
  Val   Loss: 6.6228
  ✔ Checkpoint guardado: checkpoints/dt_epoch311_val6.6226.pt
Epoch 311/2000
  Train Loss: 6.6223
  Val   Loss: 6.6226
Epoch 321/2000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 331/2000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 341/2000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 351/2000
  Train Loss: 6.6223
  Val   Loss: 6.6231
Epoch 361/2000
  Train Loss: 6.6224
  Val   Loss: 6.6232
Epoch 371/2000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 381/2000
  Train Loss: 6.6223
  Val   Loss: 6.6232
Epoch 391/2000
  Train Loss: 6.6225
  Val   Loss: 6.6231
Epoch 401/2000
  Train Loss: 6.6224
  Val   Loss: 6.6227
Epoch 411/2000
  Train Loss: 6.6223
  Val   Loss: 6.6232
Epoch 421/2000
  Train Loss: 6.6224
  Val   Loss: 6.6233
Epoch 431/2000
  Train Loss: 6.6223
  Val   Loss: 6.6230
Epoch 441/2000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 451/2000
  Train Loss: 6.6224
  Val   Loss: 6.6229
Epoch 461/2000
  Train Loss: 6.6224
  Val   Loss: 6.6233
Epoch 471/2000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 481/2000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 491/2000
  Train Loss: 6.6225
  Val   Loss: 6.6231
Epoch 501/2000
  Train Loss: 6.6224
  Val   Loss: 6.6229
Epoch 511/2000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 521/2000
  Train Loss: 6.6224
  Val   Loss: 6.6232
Epoch 531/2000
  Train Loss: 6.6225
  Val   Loss: 6.6231
Epoch 541/2000
  Train Loss: 6.6225
  Val   Loss: 6.6232
Epoch 551/2000
  Train Loss: 6.6224
  Val   Loss: 6.6229
Epoch 561/2000
  Train Loss: 6.6224
  Val   Loss: 6.6229
Epoch 571/2000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 581/2000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 591/2000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 601/2000
  Train Loss: 6.6223
  Val   Loss: 6.6231
Epoch 611/2000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 621/2000
  Train Loss: 6.6224
  Val   Loss: 6.6228
Epoch 631/2000
  Train Loss: 6.6225
  Val   Loss: 6.6231
Epoch 641/2000
  Train Loss: 6.6224
  Val   Loss: 6.6232
Epoch 651/2000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 661/2000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 671/2000
  Train Loss: 6.6224
  Val   Loss: 6.6228
Epoch 681/2000
  Train Loss: 6.6224
  Val   Loss: 6.6233
Epoch 691/2000
  Train Loss: 6.6223
  Val   Loss: 6.6229
Epoch 701/2000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 711/2000
  Train Loss: 6.6223
  Val   Loss: 6.6231
Epoch 721/2000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 731/2000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 741/2000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 751/2000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 761/2000
  Train Loss: 6.6225
  Val   Loss: 6.6227
Epoch 771/2000
  Train Loss: 6.6225
  Val   Loss: 6.6230
Epoch 781/2000
  Train Loss: 6.6224
  Val   Loss: 6.6228
Epoch 791/2000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 801/2000
  Train Loss: 6.6224
  Val   Loss: 6.6229
Epoch 811/2000
  Train Loss: 6.6224
  Val   Loss: 6.6229
Epoch 821/2000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 831/2000
  Train Loss: 6.6224
  Val   Loss: 6.6232
Epoch 841/2000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 851/2000
  Train Loss: 6.6224
  Val   Loss: 6.6229
Epoch 861/2000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 871/2000
  Train Loss: 6.6225
  Val   Loss: 6.6228
Epoch 881/2000
  Train Loss: 6.6223
  Val   Loss: 6.6231
Epoch 891/2000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 901/2000
  Train Loss: 6.6224
  Val   Loss: 6.6228
Epoch 911/2000
  Train Loss: 6.6224
  Val   Loss: 6.6228
Epoch 921/2000
  Train Loss: 6.6224
  Val   Loss: 6.6229
Epoch 931/2000
  Train Loss: 6.6224
  Val   Loss: 6.6229
Epoch 941/2000
  Train Loss: 6.6224
  Val   Loss: 6.6232
Epoch 951/2000
  Train Loss: 6.6225
  Val   Loss: 6.6229
Epoch 961/2000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 971/2000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 981/2000
  Train Loss: 6.6224
  Val   Loss: 6.6232
Epoch 991/2000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 1001/2000
  Train Loss: 6.6223
  Val   Loss: 6.6227
Epoch 1011/2000
  Train Loss: 6.6224
  Val   Loss: 6.6229
Epoch 1021/2000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 1031/2000
  Train Loss: 6.6225
  Val   Loss: 6.6228
Epoch 1041/2000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 1051/2000
  Train Loss: 6.6225
  Val   Loss: 6.6229
Epoch 1061/2000
  Train Loss: 6.6224
  Val   Loss: 6.6229
Epoch 1071/2000
  Train Loss: 6.6223
  Val   Loss: 6.6230
Epoch 1081/2000
  Train Loss: 6.6224
  Val   Loss: 6.6229
Epoch 1091/2000
  Train Loss: 6.6223
  Val   Loss: 6.6232
Epoch 1101/2000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 1111/2000
  Train Loss: 6.6224
  Val   Loss: 6.6229
Epoch 1121/2000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 1131/2000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 1141/2000
  Train Loss: 6.6225
  Val   Loss: 6.6230
Epoch 1151/2000
  Train Loss: 6.6224
  Val   Loss: 6.6233
Epoch 1161/2000
  Train Loss: 6.6224
  Val   Loss: 6.6229
Epoch 1171/2000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 1181/2000
  Train Loss: 6.6224
  Val   Loss: 6.6229
Epoch 1191/2000
  Train Loss: 6.6224
  Val   Loss: 6.6227
Epoch 1201/2000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 1211/2000
  Train Loss: 6.6224
  Val   Loss: 6.6226
Epoch 1221/2000
  Train Loss: 6.6223
  Val   Loss: 6.6229
Epoch 1231/2000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 1241/2000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 1251/2000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 1261/2000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 1271/2000
  Train Loss: 6.6225
  Val   Loss: 6.6232
Epoch 1281/2000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 1291/2000
  Train Loss: 6.6224
  Val   Loss: 6.6229
Epoch 1301/2000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 1311/2000
  Train Loss: 6.6223
  Val   Loss: 6.6231
Epoch 1321/2000
  Train Loss: 6.6225
  Val   Loss: 6.6231
Epoch 1331/2000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 1341/2000
  Train Loss: 6.6224
  Val   Loss: 6.6229
Epoch 1351/2000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 1361/2000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 1371/2000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 1381/2000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 1391/2000
  Train Loss: 6.6225
  Val   Loss: 6.6229
Epoch 1401/2000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 1411/2000
  Train Loss: 6.6223
  Val   Loss: 6.6229
Epoch 1421/2000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 1431/2000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 1441/2000
  Train Loss: 6.6223
  Val   Loss: 6.6229
Epoch 1451/2000
  Train Loss: 6.6225
  Val   Loss: 6.6231
Epoch 1461/2000
  Train Loss: 6.6224
  Val   Loss: 6.6229
Epoch 1471/2000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 1481/2000
  Train Loss: 6.6223
  Val   Loss: 6.6231
Epoch 1491/2000
  Train Loss: 6.6225
  Val   Loss: 6.6228
Epoch 1501/2000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 1511/2000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 1521/2000
  Train Loss: 6.6224
  Val   Loss: 6.6232
Epoch 1531/2000
  Train Loss: 6.6224
  Val   Loss: 6.6229
Epoch 1541/2000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 1551/2000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 1561/2000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 1571/2000
  Train Loss: 6.6224
  Val   Loss: 6.6228
Epoch 1581/2000
  Train Loss: 6.6224
  Val   Loss: 6.6229
Epoch 1591/2000
  Train Loss: 6.6225
  Val   Loss: 6.6231
Epoch 1601/2000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 1611/2000
  Train Loss: 6.6224
  Val   Loss: 6.6229
Epoch 1621/2000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 1631/2000
  Train Loss: 6.6224
  Val   Loss: 6.6228
Epoch 1641/2000
  Train Loss: 6.6224
  Val   Loss: 6.6229
Epoch 1651/2000
  Train Loss: 6.6225
  Val   Loss: 6.6229
Epoch 1661/2000
  Train Loss: 6.6223
  Val   Loss: 6.6231
Epoch 1671/2000
  Train Loss: 6.6223
  Val   Loss: 6.6231
Epoch 1681/2000
  Train Loss: 6.6223
  Val   Loss: 6.6232
Epoch 1691/2000
  Train Loss: 6.6224
  Val   Loss: 6.6232
Epoch 1701/2000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 1711/2000
  Train Loss: 6.6223
  Val   Loss: 6.6229
Epoch 1721/2000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 1731/2000
  Train Loss: 6.6225
  Val   Loss: 6.6227
Epoch 1741/2000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 1751/2000
  Train Loss: 6.6224
  Val   Loss: 6.6229
Epoch 1761/2000
  Train Loss: 6.6224
  Val   Loss: 6.6229
Epoch 1771/2000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 1781/2000
  Train Loss: 6.6225
  Val   Loss: 6.6230
Epoch 1791/2000
  Train Loss: 6.6224
  Val   Loss: 6.6229
Epoch 1801/2000
  Train Loss: 6.6224
  Val   Loss: 6.6229
Epoch 1811/2000
  Train Loss: 6.6224
  Val   Loss: 6.6228
Epoch 1821/2000
  Train Loss: 6.6223
  Val   Loss: 6.6231
Epoch 1831/2000
  Train Loss: 6.6223
  Val   Loss: 6.6230
Epoch 1841/2000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 1851/2000
  Train Loss: 6.6225
  Val   Loss: 6.6230
Epoch 1861/2000
  Train Loss: 6.6224
  Val   Loss: 6.6229
Epoch 1871/2000
  Train Loss: 6.6224
  Val   Loss: 6.6229
Epoch 1881/2000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 1891/2000
  Train Loss: 6.6225
  Val   Loss: 6.6229
Epoch 1901/2000
  Train Loss: 6.6224
  Val   Loss: 6.6232
Epoch 1911/2000
  Train Loss: 6.6223
  Val   Loss: 6.6230
Epoch 1921/2000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 1931/2000
  Train Loss: 6.6225
  Val   Loss: 6.6232
Epoch 1941/2000
  Train Loss: 6.6224
  Val   Loss: 6.6229
Epoch 1951/2000
  Train Loss: 6.6224
  Val   Loss: 6.6234
Epoch 1961/2000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 1971/2000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 1981/2000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 1991/2000
  Train Loss: 6.6224
  Val   Loss: 6.6229
Model saved to 'trained_model_2025-12-01_21-04-07.pt'
Training history saved to 'training_history_2025-12-01_21-04-07.pkl'
