Using device: cuda
Model parameters: 2,875,120
{'items': array([472,  97, 122, 654, 709, 467, 574, 544, 478, 338, 301, 185, 156,
       712, 525, 225, 396, 370, 589, 750, 586, 353, 416, 687, 465, 433,
       215, 438, 219, 528, 134, 444,  92,  24, 145, 572,  22, 454, 715,
       364,  19, 115, 386, 374, 203, 229,  44, 624, 303, 152, 206, 268,
       329, 692,   8,  12, 291, 633, 537, 457, 121, 689, 164, 114, 566,
       519, 234, 154, 104,  74,  49,  86, 419, 315, 387, 663, 400]), 'ratings': array([4., 3., 4., 3., 5., 4., 2., 1., 4., 5., 5., 3., 4., 4., 4., 2., 5.,
       5., 5., 4., 4., 3., 4., 5., 1., 1., 5., 4., 4., 4., 4., 4., 4., 5.,
       2., 4., 5., 3., 4., 3., 2., 1., 5., 3., 4., 4., 3., 5., 4., 5., 4.,
       5., 4., 3., 4., 4., 5., 5., 3., 2., 4., 5., 5., 5., 2., 5., 5., 2.,
       4., 5., 4., 5., 4., 5., 4., 3., 5.]), 'returns_to_go': array([296., 292., 289., 285., 282., 277., 273., 271., 270., 266., 261.,
       256., 253., 249., 245., 241., 239., 234., 229., 224., 220., 216.,
       213., 209., 204., 203., 202., 197., 193., 189., 185., 181., 177.,
       173., 168., 166., 162., 157., 154., 150., 147., 145., 144., 139.,
       136., 132., 128., 125., 120., 116., 111., 107., 102.,  98.,  95.,
        91.,  87.,  82.,  77.,  74.,  72.,  68.,  63.,  58.,  53.,  51.,
        46.,  41.,  39.,  35.,  30.,  26.,  21.,  17.,  12.,   8.,   5.]), 'timesteps': array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16,
       17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33,
       34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50,
       51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67,
       68, 69, 70, 71, 72, 73, 74, 75, 76], dtype=int32), 'user_group': 0}
Number of training trajectories: 16000
<dataset_reference.RecommendationDatasetReference object at 0x7fdb6b19fc90>

Dataset details:
Dataset train size: 14400
Batches per epoch (train): 225
Dataset val size: 1600
Batches per epoch (val): 25
  ✔ Checkpoint guardado: checkpoints/dt_epoch1_val6.6249.pt
Epoch 1/1000
  Train Loss: 6.6312
  Val   Loss: 6.6249
  ✔ Checkpoint guardado: checkpoints/dt_epoch11_val6.6233.pt
Epoch 11/1000
  Train Loss: 6.6232
  Val   Loss: 6.6233
  ✔ Checkpoint guardado: checkpoints/dt_epoch21_val6.6232.pt
Epoch 21/1000
  Train Loss: 6.6228
  Val   Loss: 6.6232
  ✔ Checkpoint guardado: checkpoints/dt_epoch31_val6.6231.pt
Epoch 31/1000
  Train Loss: 6.6227
  Val   Loss: 6.6231
  ✔ Checkpoint guardado: checkpoints/dt_epoch41_val6.6230.pt
Epoch 41/1000
  Train Loss: 6.6226
  Val   Loss: 6.6230
Epoch 51/1000
  Train Loss: 6.6225
  Val   Loss: 6.6231
Epoch 61/1000
  Train Loss: 6.6225
  Val   Loss: 6.6230
Epoch 71/1000
  Train Loss: 6.6224
  Val   Loss: 6.6231
  ✔ Checkpoint guardado: checkpoints/dt_epoch81_val6.6230.pt
Epoch 81/1000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 91/1000
  Train Loss: 6.6224
  Val   Loss: 6.6230
  ✔ Checkpoint guardado: checkpoints/dt_epoch101_val6.6228.pt
Epoch 101/1000
  Train Loss: 6.6224
  Val   Loss: 6.6228
Epoch 111/1000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 121/1000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 131/1000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 141/1000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 151/1000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 161/1000
  Train Loss: 6.6223
  Val   Loss: 6.6230
Epoch 171/1000
  Train Loss: 6.6224
  Val   Loss: 6.6232
Epoch 181/1000
  Train Loss: 6.6224
  Val   Loss: 6.6229
Epoch 191/1000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 201/1000
  Train Loss: 6.6224
  Val   Loss: 6.6233
Epoch 211/1000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 221/1000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 231/1000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 241/1000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 251/1000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 261/1000
  Train Loss: 6.6223
  Val   Loss: 6.6232
Epoch 271/1000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 281/1000
  Train Loss: 6.6223
  Val   Loss: 6.6231
Epoch 291/1000
  Train Loss: 6.6224
  Val   Loss: 6.6229
Epoch 301/1000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 311/1000
  Train Loss: 6.6223
  Val   Loss: 6.6231
Epoch 321/1000
  Train Loss: 6.6225
  Val   Loss: 6.6231
Epoch 331/1000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 341/1000
  Train Loss: 6.6223
  Val   Loss: 6.6230
Epoch 351/1000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 361/1000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 371/1000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 381/1000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 391/1000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 401/1000
  Train Loss: 6.6224
  Val   Loss: 6.6232
Epoch 411/1000
  Train Loss: 6.6224
  Val   Loss: 6.6232
Epoch 421/1000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 431/1000
  Train Loss: 6.6224
  Val   Loss: 6.6232
Epoch 441/1000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 451/1000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 461/1000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 471/1000
  Train Loss: 6.6225
  Val   Loss: 6.6230
Epoch 481/1000
  Train Loss: 6.6224
  Val   Loss: 6.6232
Epoch 491/1000
  Train Loss: 6.6224
  Val   Loss: 6.6232
Epoch 501/1000
  Train Loss: 6.6223
  Val   Loss: 6.6229
Epoch 511/1000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 521/1000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 531/1000
  Train Loss: 6.6224
  Val   Loss: 6.6232
Epoch 541/1000
  Train Loss: 6.6224
  Val   Loss: 6.6234
Epoch 551/1000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 561/1000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 571/1000
  Train Loss: 6.6224
  Val   Loss: 6.6232
Epoch 581/1000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 591/1000
  Train Loss: 6.6223
  Val   Loss: 6.6231
Epoch 601/1000
  Train Loss: 6.6224
  Val   Loss: 6.6229
Epoch 611/1000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 621/1000
  Train Loss: 6.6224
  Val   Loss: 6.6229
Epoch 631/1000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 641/1000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 651/1000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 661/1000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 671/1000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 681/1000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 691/1000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 701/1000
  Train Loss: 6.6224
  Val   Loss: 6.6232
Epoch 711/1000
  Train Loss: 6.6223
  Val   Loss: 6.6230
Epoch 721/1000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 731/1000
  Train Loss: 6.6225
  Val   Loss: 6.6230
Epoch 741/1000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 751/1000
  Train Loss: 6.6224
  Val   Loss: 6.6229
Epoch 761/1000
  Train Loss: 6.6224
  Val   Loss: 6.6232
Epoch 771/1000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 781/1000
  Train Loss: 6.6224
  Val   Loss: 6.6233
Epoch 791/1000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 801/1000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 811/1000
  Train Loss: 6.6224
  Val   Loss: 6.6229
Epoch 821/1000
  Train Loss: 6.6224
  Val   Loss: 6.6228
Epoch 831/1000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 841/1000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 851/1000
  Train Loss: 6.6223
  Val   Loss: 6.6230
Epoch 861/1000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 871/1000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 881/1000
  Train Loss: 6.6224
  Val   Loss: 6.6232
Epoch 891/1000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 901/1000
  Train Loss: 6.6224
  Val   Loss: 6.6230
Epoch 911/1000
  Train Loss: 6.6223
  Val   Loss: 6.6231
Epoch 921/1000
  Train Loss: 6.6224
  Val   Loss: 6.6233
Epoch 931/1000
  Train Loss: 6.6224
  Val   Loss: 6.6232
Epoch 941/1000
  Train Loss: 6.6224
  Val   Loss: 6.6234
Epoch 951/1000
  Train Loss: 6.6224
  Val   Loss: 6.6233
Epoch 961/1000
  Train Loss: 6.6224
  Val   Loss: 6.6231
Epoch 971/1000
  Train Loss: 6.6223
  Val   Loss: 6.6231
Epoch 981/1000
  Train Loss: 6.6224
  Val   Loss: 6.6229
Epoch 991/1000
  Train Loss: 6.6224
  Val   Loss: 6.6229
Model saved to 'trained_model_2025-12-01_11-30-57.pt'
Training history saved to 'training_history_2025-12-01_11-30-57.pkl'
