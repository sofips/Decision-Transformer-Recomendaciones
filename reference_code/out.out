Using device: cuda
Model parameters: 831,728
{'items': array([472,  97, 122, 654, 709, 467, 574, 544, 478, 338, 301, 185, 156,
       712, 525, 225, 396, 370, 589, 750, 586, 353, 416, 687, 465, 433,
       215, 438, 219, 528, 134, 444,  92,  24, 145, 572,  22, 454, 715,
       364,  19, 115, 386, 374, 203, 229,  44, 624, 303, 152, 206, 268,
       329, 692,   8,  12, 291, 633, 537, 457, 121, 689, 164, 114, 566,
       519, 234, 154, 104,  74,  49,  86, 419, 315, 387, 663, 400]), 'ratings': array([4., 3., 4., 3., 5., 4., 2., 1., 4., 5., 5., 3., 4., 4., 4., 2., 5.,
       5., 5., 4., 4., 3., 4., 5., 1., 1., 5., 4., 4., 4., 4., 4., 4., 5.,
       2., 4., 5., 3., 4., 3., 2., 1., 5., 3., 4., 4., 3., 5., 4., 5., 4.,
       5., 4., 3., 4., 4., 5., 5., 3., 2., 4., 5., 5., 5., 2., 5., 5., 2.,
       4., 5., 4., 5., 4., 5., 4., 3., 5.]), 'returns_to_go': array([ 0.48681003,  0.46156233,  0.44262656,  0.41737887,  0.3984431 ,
        0.36688349,  0.34163579,  0.32901195,  0.32270002,  0.29745233,
        0.26589271,  0.2343331 ,  0.21539733,  0.19014963,  0.16490194,
        0.13965425,  0.1270304 ,  0.09547078,  0.06391117,  0.03235155,
        0.00710386, -0.01814384, -0.03707961, -0.0623273 , -0.09388691,
       -0.10019884, -0.10651076, -0.13807038, -0.16331807, -0.18856576,
       -0.21381346, -0.23906115, -0.26430884, -0.28955654, -0.32111615,
       -0.33374   , -0.35898769, -0.39054731, -0.40948308, -0.43473077,
       -0.45366654, -0.46629039, -0.47260231, -0.50416193, -0.5230977 ,
       -0.54834539, -0.57359308, -0.59252885, -0.62408847, -0.64933616,
       -0.68089578, -0.70614347, -0.73770309, -0.76295078, -0.78188655,
       -0.80713425, -0.83238194, -0.86394156, -0.89550117, -0.91443694,
       -0.92706079, -0.95230848, -0.9838681 , -1.01542771, -1.04698733,
       -1.05961118, -1.09117079, -1.12273041, -1.13535426, -1.16060195,
       -1.19216157, -1.21740926, -1.24896888, -1.27421657, -1.30577619,
       -1.33102388, -1.34995965]), 'timesteps': array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16,
       17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33,
       34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50,
       51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67,
       68, 69, 70, 71, 72, 73, 74, 75, 76], dtype=int32), 'user_group': 0}
Number of training trajectories: 16000
<dataset_reference.RecommendationDatasetReference object at 0x7f55831e1bd0>

Dataset details:
Dataset train size: 14400
Batches per epoch (train): 225
Dataset val size: 1600
Batches per epoch (val): 25
  ✔ Checkpoint guardado: checkpoints/dt_epoch1_val6.6372.pt
Epoch 1/2000
  Train Loss: 6.6428
  Val   Loss: 6.6372
  ✔ Checkpoint guardado: checkpoints/dt_epoch11_val6.6236.pt
Epoch 11/2000
  Train Loss: 6.6237
  Val   Loss: 6.6236
  ✔ Checkpoint guardado: checkpoints/dt_epoch21_val6.6234.pt
Epoch 21/2000
  Train Loss: 6.6231
  Val   Loss: 6.6234
Epoch 31/2000
  Train Loss: 6.6167
  Val   Loss: 6.6270
Epoch 41/2000
  Train Loss: 6.6003
  Val   Loss: 6.6351
Epoch 51/2000
  Train Loss: 6.5816
  Val   Loss: 6.6443
Epoch 61/2000
  Train Loss: 6.5596
  Val   Loss: 6.6648
Epoch 71/2000
  Train Loss: 6.5343
  Val   Loss: 6.6824
Epoch 81/2000
  Train Loss: 6.5060
  Val   Loss: 6.7056
Epoch 91/2000
  Train Loss: 6.4760
  Val   Loss: 6.7370
Epoch 101/2000
  Train Loss: 6.4450
  Val   Loss: 6.7629
Epoch 111/2000
  Train Loss: 6.4178
  Val   Loss: 6.8038
Epoch 121/2000
  Train Loss: 6.3886
  Val   Loss: 6.8332
Epoch 131/2000
  Train Loss: 6.3591
  Val   Loss: 6.8794
Epoch 141/2000
  Train Loss: 6.3360
  Val   Loss: 6.9148
Epoch 151/2000
  Train Loss: 6.3093
  Val   Loss: 6.9454
Epoch 161/2000
  Train Loss: 6.2900
  Val   Loss: 6.9798
Epoch 171/2000
  Train Loss: 6.2661
  Val   Loss: 7.0156
Epoch 181/2000
  Train Loss: 6.2480
  Val   Loss: 7.0419
Epoch 191/2000
  Train Loss: 6.2324
  Val   Loss: 7.0774
Epoch 201/2000
  Train Loss: 6.2094
  Val   Loss: 7.1128
Epoch 211/2000
  Train Loss: 6.1946
  Val   Loss: 7.1172
Epoch 221/2000
  Train Loss: 6.1804
  Val   Loss: 7.1637
Epoch 231/2000
  Train Loss: 6.1734
  Val   Loss: 7.1997
Epoch 241/2000
  Train Loss: 6.1548
  Val   Loss: 7.2183
Epoch 251/2000
  Train Loss: 6.1474
  Val   Loss: 7.2677
Epoch 261/2000
  Train Loss: 6.1321
  Val   Loss: 7.2629
Epoch 271/2000
  Train Loss: 6.1232
  Val   Loss: 7.2972
Epoch 281/2000
  Train Loss: 6.1123
  Val   Loss: 7.3248
Epoch 291/2000
  Train Loss: 6.1024
  Val   Loss: 7.3531
Epoch 301/2000
  Train Loss: 6.0917
  Val   Loss: 7.3830
Epoch 311/2000
  Train Loss: 6.0838
  Val   Loss: 7.4073
Epoch 321/2000
  Train Loss: 6.0750
  Val   Loss: 7.4130
Epoch 331/2000
  Train Loss: 6.0664
  Val   Loss: 7.4403
Epoch 341/2000
  Train Loss: 6.0622
  Val   Loss: 7.4660
Epoch 351/2000
  Train Loss: 6.0538
  Val   Loss: 7.4697
Epoch 361/2000
  Train Loss: 6.0402
  Val   Loss: 7.5002
Epoch 371/2000
  Train Loss: 6.0321
  Val   Loss: 7.5297
Epoch 381/2000
  Train Loss: 6.0315
  Val   Loss: 7.5346
Epoch 391/2000
  Train Loss: 6.0252
  Val   Loss: 7.5559
Epoch 401/2000
  Train Loss: 6.0183
  Val   Loss: 7.5789
Epoch 411/2000
  Train Loss: 6.0132
  Val   Loss: 7.5816
Epoch 421/2000
  Train Loss: 6.0112
  Val   Loss: 7.6178
Epoch 431/2000
  Train Loss: 6.0035
  Val   Loss: 7.6516
Epoch 441/2000
  Train Loss: 5.9970
  Val   Loss: 7.6662
Epoch 451/2000
  Train Loss: 5.9902
  Val   Loss: 7.6413
Epoch 461/2000
  Train Loss: 5.9865
  Val   Loss: 7.6494
Epoch 471/2000
  Train Loss: 5.9805
  Val   Loss: 7.6753
Epoch 481/2000
  Train Loss: 5.9800
  Val   Loss: 7.7103
Epoch 491/2000
  Train Loss: 5.9755
  Val   Loss: 7.7130
Epoch 501/2000
  Train Loss: 5.9700
  Val   Loss: 7.7327
Epoch 511/2000
  Train Loss: 5.9619
  Val   Loss: 7.7125
Epoch 521/2000
  Train Loss: 5.9582
  Val   Loss: 7.7643
Epoch 531/2000
  Train Loss: 5.9528
  Val   Loss: 7.7564
Epoch 541/2000
  Train Loss: 5.9551
  Val   Loss: 7.7863
Epoch 551/2000
  Train Loss: 5.9468
  Val   Loss: 7.7880
Epoch 561/2000
  Train Loss: 5.9466
  Val   Loss: 7.7452
Epoch 571/2000
  Train Loss: 5.9415
  Val   Loss: 7.8283
Epoch 581/2000
  Train Loss: 5.9406
  Val   Loss: 7.8278
Epoch 591/2000
  Train Loss: 5.9356
  Val   Loss: 7.8237
Epoch 601/2000
  Train Loss: 5.9323
  Val   Loss: 7.8331
Epoch 611/2000
  Train Loss: 5.9311
  Val   Loss: 7.8466
Epoch 621/2000
  Train Loss: 5.9261
  Val   Loss: 7.8197
Epoch 631/2000
  Train Loss: 5.9231
  Val   Loss: 7.8323
Epoch 641/2000
  Train Loss: 5.9173
  Val   Loss: 7.8653
Epoch 651/2000
  Train Loss: 5.9214
  Val   Loss: 7.8826
Epoch 661/2000
  Train Loss: 5.9143
  Val   Loss: 7.9168
Epoch 671/2000
  Train Loss: 5.9090
  Val   Loss: 7.8896
Epoch 681/2000
  Train Loss: 5.9094
  Val   Loss: 7.9291
Epoch 691/2000
  Train Loss: 5.9043
  Val   Loss: 7.8994
Epoch 701/2000
  Train Loss: 5.9008
  Val   Loss: 7.9293
Epoch 711/2000
  Train Loss: 5.8983
  Val   Loss: 7.9519
Epoch 721/2000
  Train Loss: 5.8958
  Val   Loss: 7.9664
Epoch 731/2000
  Train Loss: 5.8921
  Val   Loss: 7.9299
Epoch 741/2000
  Train Loss: 5.8914
  Val   Loss: 7.9740
Epoch 751/2000
  Train Loss: 5.8903
  Val   Loss: 7.9723
Epoch 761/2000
  Train Loss: 5.8896
  Val   Loss: 8.0089
Epoch 771/2000
  Train Loss: 5.8832
  Val   Loss: 7.9703
Epoch 781/2000
  Train Loss: 5.8920
  Val   Loss: 8.0026
Epoch 791/2000
  Train Loss: 5.8763
  Val   Loss: 8.0304
Epoch 801/2000
  Train Loss: 5.8730
  Val   Loss: 8.0224
Epoch 811/2000
  Train Loss: 5.8733
  Val   Loss: 8.0150
Epoch 821/2000
  Train Loss: 5.8764
  Val   Loss: 8.0402
Epoch 831/2000
  Train Loss: 5.8691
  Val   Loss: 8.0203
Epoch 841/2000
  Train Loss: 5.8723
  Val   Loss: 8.0266
Epoch 851/2000
  Train Loss: 5.8699
  Val   Loss: 8.0874
Epoch 861/2000
  Train Loss: 5.8664
  Val   Loss: 8.0567
Epoch 871/2000
  Train Loss: 5.8603
  Val   Loss: 8.0676
Epoch 881/2000
  Train Loss: 5.8618
  Val   Loss: 8.0541
Epoch 891/2000
  Train Loss: 5.8560
  Val   Loss: 8.0899
Epoch 901/2000
  Train Loss: 5.8589
  Val   Loss: 8.0965
Epoch 911/2000
  Train Loss: 5.8561
  Val   Loss: 8.1437
Epoch 921/2000
  Train Loss: 5.8502
  Val   Loss: 8.1046
Epoch 931/2000
  Train Loss: 5.8536
  Val   Loss: 8.1072
Epoch 941/2000
  Train Loss: 5.8535
  Val   Loss: 8.0991
Epoch 951/2000
  Train Loss: 5.8483
  Val   Loss: 8.0997
Epoch 961/2000
  Train Loss: 5.8478
  Val   Loss: 8.1504
Epoch 971/2000
  Train Loss: 5.8447
  Val   Loss: 8.1473
Epoch 981/2000
  Train Loss: 5.8397
  Val   Loss: 8.1122
Epoch 991/2000
  Train Loss: 5.8380
  Val   Loss: 8.1579
Epoch 1001/2000
  Train Loss: 5.8414
  Val   Loss: 8.1430
Epoch 1011/2000
  Train Loss: 5.8378
  Val   Loss: 8.1510
Epoch 1021/2000
  Train Loss: 5.8324
  Val   Loss: 8.1445
Epoch 1031/2000
  Train Loss: 5.8309
  Val   Loss: 8.1791
Epoch 1041/2000
  Train Loss: 5.8315
  Val   Loss: 8.1761
Epoch 1051/2000
  Train Loss: 5.8323
  Val   Loss: 8.1347
Epoch 1061/2000
  Train Loss: 5.8272
  Val   Loss: 8.1200
Epoch 1071/2000
  Train Loss: 5.8283
  Val   Loss: 8.1775
Epoch 1081/2000
  Train Loss: 5.8319
  Val   Loss: 8.1718
Epoch 1091/2000
  Train Loss: 5.8230
  Val   Loss: 8.1977
Epoch 1101/2000
  Train Loss: 5.8314
  Val   Loss: 8.1889
Epoch 1111/2000
  Train Loss: 5.8239
  Val   Loss: 8.1939
Epoch 1121/2000
  Train Loss: 5.8199
  Val   Loss: 8.1996
Epoch 1131/2000
  Train Loss: 5.8220
  Val   Loss: 8.2179
Epoch 1141/2000
  Train Loss: 5.8178
  Val   Loss: 8.1950
Epoch 1151/2000
  Train Loss: 5.8150
  Val   Loss: 8.1811
Epoch 1161/2000
  Train Loss: 5.8146
  Val   Loss: 8.2027
Epoch 1171/2000
  Train Loss: 5.8141
  Val   Loss: 8.2398
Epoch 1181/2000
  Train Loss: 5.8123
  Val   Loss: 8.2110
Epoch 1191/2000
  Train Loss: 5.8110
  Val   Loss: 8.2745
Epoch 1201/2000
  Train Loss: 5.8151
  Val   Loss: 8.1944
Epoch 1211/2000
  Train Loss: 5.8143
  Val   Loss: 8.2545
Epoch 1221/2000
  Train Loss: 5.8027
  Val   Loss: 8.2516
Epoch 1231/2000
  Train Loss: 5.8085
  Val   Loss: 8.2775
Epoch 1241/2000
  Train Loss: 5.8001
  Val   Loss: 8.2631
Epoch 1251/2000
  Train Loss: 5.8124
  Val   Loss: 8.2600
Epoch 1261/2000
  Train Loss: 5.8074
  Val   Loss: 8.2449
Epoch 1271/2000
  Train Loss: 5.8030
  Val   Loss: 8.2964
Epoch 1281/2000
  Train Loss: 5.8049
  Val   Loss: 8.2469
Epoch 1291/2000
  Train Loss: 5.7986
  Val   Loss: 8.2642
Epoch 1301/2000
  Train Loss: 5.8017
  Val   Loss: 8.2640
Epoch 1311/2000
  Train Loss: 5.8007
  Val   Loss: 8.2391
Epoch 1321/2000
  Train Loss: 5.7993
  Val   Loss: 8.3110
Epoch 1331/2000
  Train Loss: 5.8000
  Val   Loss: 8.2692
Epoch 1341/2000
  Train Loss: 5.7968
  Val   Loss: 8.2833
Epoch 1351/2000
  Train Loss: 5.7944
  Val   Loss: 8.2585
Epoch 1361/2000
  Train Loss: 5.7967
  Val   Loss: 8.3371
Epoch 1371/2000
  Train Loss: 5.7917
  Val   Loss: 8.3312
Epoch 1381/2000
  Train Loss: 5.7852
  Val   Loss: 8.2903
Epoch 1391/2000
  Train Loss: 5.7914
  Val   Loss: 8.3045
Epoch 1401/2000
  Train Loss: 5.7869
  Val   Loss: 8.3582
Epoch 1411/2000
  Train Loss: 5.7872
  Val   Loss: 8.3166
Epoch 1421/2000
  Train Loss: 5.7899
  Val   Loss: 8.3462
Epoch 1431/2000
  Train Loss: 5.7841
  Val   Loss: 8.3407
Epoch 1441/2000
  Train Loss: 5.7828
  Val   Loss: 8.3346
Epoch 1451/2000
  Train Loss: 5.7845
  Val   Loss: 8.3506
Epoch 1461/2000
  Train Loss: 5.7816
  Val   Loss: 8.3182
Epoch 1471/2000
  Train Loss: 5.7828
  Val   Loss: 8.3282
Epoch 1481/2000
  Train Loss: 5.7768
  Val   Loss: 8.3969
Epoch 1491/2000
  Train Loss: 5.7775
  Val   Loss: 8.3794
Epoch 1501/2000
  Train Loss: 5.7791
  Val   Loss: 8.3832
Epoch 1511/2000
  Train Loss: 5.7732
  Val   Loss: 8.3243
Epoch 1521/2000
  Train Loss: 5.7755
  Val   Loss: 8.3803
Epoch 1531/2000
  Train Loss: 5.7777
  Val   Loss: 8.3648
Epoch 1541/2000
  Train Loss: 5.7801
  Val   Loss: 8.3776
Epoch 1551/2000
  Train Loss: 5.7727
  Val   Loss: 8.3389
Epoch 1561/2000
  Train Loss: 5.7758
  Val   Loss: 8.3518
Epoch 1571/2000
  Train Loss: 5.7700
  Val   Loss: 8.3713
Epoch 1581/2000
  Train Loss: 5.7717
  Val   Loss: 8.3766
Epoch 1591/2000
  Train Loss: 5.7730
  Val   Loss: 8.3909
Epoch 1601/2000
  Train Loss: 5.7689
  Val   Loss: 8.3736
Epoch 1611/2000
  Train Loss: 5.7700
  Val   Loss: 8.3881
Epoch 1621/2000
  Train Loss: 5.7686
  Val   Loss: 8.3893
Epoch 1631/2000
  Train Loss: 5.7706
  Val   Loss: 8.3953
Epoch 1641/2000
  Train Loss: 5.7678
  Val   Loss: 8.4080
Epoch 1651/2000
  Train Loss: 5.7617
  Val   Loss: 8.3985
Epoch 1661/2000
  Train Loss: 5.7680
  Val   Loss: 8.4101
Epoch 1671/2000
  Train Loss: 5.7615
  Val   Loss: 8.4327
Epoch 1681/2000
  Train Loss: 5.7585
  Val   Loss: 8.4133
Epoch 1691/2000
  Train Loss: 5.7564
  Val   Loss: 8.4135
Epoch 1701/2000
  Train Loss: 5.7571
  Val   Loss: 8.3771
Epoch 1711/2000
  Train Loss: 5.7502
  Val   Loss: 8.3863
Epoch 1721/2000
  Train Loss: 5.7542
  Val   Loss: 8.4364
Epoch 1731/2000
  Train Loss: 5.7573
  Val   Loss: 8.4187
Epoch 1741/2000
  Train Loss: 5.7539
  Val   Loss: 8.4571
Epoch 1751/2000
  Train Loss: 5.7571
  Val   Loss: 8.3951
Epoch 1761/2000
  Train Loss: 5.7577
  Val   Loss: 8.3712
Epoch 1771/2000
  Train Loss: 5.7597
  Val   Loss: 8.4370
Epoch 1781/2000
  Train Loss: 5.7537
  Val   Loss: 8.4810
Epoch 1791/2000
  Train Loss: 5.7542
  Val   Loss: 8.4239
Epoch 1801/2000
  Train Loss: 5.7528
  Val   Loss: 8.4822
Epoch 1811/2000
  Train Loss: 5.7501
  Val   Loss: 8.4125
Epoch 1821/2000
  Train Loss: 5.7498
  Val   Loss: 8.4807
Epoch 1831/2000
  Train Loss: 5.7494
  Val   Loss: 8.4699
Epoch 1841/2000
  Train Loss: 5.7529
  Val   Loss: 8.4576
Epoch 1851/2000
  Train Loss: 5.7512
  Val   Loss: 8.4655
Epoch 1861/2000
  Train Loss: 5.7503
  Val   Loss: 8.4843
Epoch 1871/2000
  Train Loss: 5.7467
  Val   Loss: 8.4959
Epoch 1881/2000
  Train Loss: 5.7460
  Val   Loss: 8.5249
Epoch 1891/2000
  Train Loss: 5.7456
  Val   Loss: 8.4645
Epoch 1901/2000
  Train Loss: 5.7483
  Val   Loss: 8.4713
Epoch 1911/2000
  Train Loss: 5.7548
  Val   Loss: 8.4982
Epoch 1921/2000
  Train Loss: 5.7419
  Val   Loss: 8.4550
Epoch 1931/2000
  Train Loss: 5.7414
  Val   Loss: 8.5172
Epoch 1941/2000
  Train Loss: 5.7483
  Val   Loss: 8.5228
Epoch 1951/2000
  Train Loss: 5.7434
  Val   Loss: 8.4624
Epoch 1961/2000
  Train Loss: 5.7340
  Val   Loss: 8.4669
Epoch 1971/2000
  Train Loss: 5.7451
  Val   Loss: 8.5290
Epoch 1981/2000
  Train Loss: 5.7418
  Val   Loss: 8.4880
Epoch 1991/2000
  Train Loss: 5.7443
  Val   Loss: 8.4843
Model saved to 'trained_model_2025-12-02_02-58-44.pt'
Training history saved to 'training_history_2025-12-02_02-58-44.pkl'
