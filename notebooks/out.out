Using device: cuda
Model parameters: 7,570,672
{'items': array([472,  97, 122, 654, 709, 467, 574, 544, 478, 338, 301, 185, 156,
       712, 525, 225, 396, 370, 589, 750, 586, 353, 416, 687, 465, 433,
       215, 438, 219, 528, 134, 444,  92,  24, 145, 572,  22, 454, 715,
       364,  19, 115, 386, 374, 203, 229,  44, 624, 303, 152, 206, 268,
       329, 692,   8,  12, 291, 633, 537, 457, 121, 689, 164, 114, 566,
       519, 234, 154, 104,  74,  49,  86, 419, 315, 387, 663, 400]), 'ratings': array([4., 3., 4., 3., 5., 4., 2., 1., 4., 5., 5., 3., 4., 4., 4., 2., 5.,
       5., 5., 4., 4., 3., 4., 5., 1., 1., 5., 4., 4., 4., 4., 4., 4., 5.,
       2., 4., 5., 3., 4., 3., 2., 1., 5., 3., 4., 4., 3., 5., 4., 5., 4.,
       5., 4., 3., 4., 4., 5., 5., 3., 2., 4., 5., 5., 5., 2., 5., 5., 2.,
       4., 5., 4., 5., 4., 5., 4., 3., 5.]), 'returns_to_go': array([ 0.48681003,  0.46156233,  0.44262656,  0.41737887,  0.3984431 ,
        0.36688349,  0.34163579,  0.32901195,  0.32270002,  0.29745233,
        0.26589271,  0.2343331 ,  0.21539733,  0.19014963,  0.16490194,
        0.13965425,  0.1270304 ,  0.09547078,  0.06391117,  0.03235155,
        0.00710386, -0.01814384, -0.03707961, -0.0623273 , -0.09388691,
       -0.10019884, -0.10651076, -0.13807038, -0.16331807, -0.18856576,
       -0.21381346, -0.23906115, -0.26430884, -0.28955654, -0.32111615,
       -0.33374   , -0.35898769, -0.39054731, -0.40948308, -0.43473077,
       -0.45366654, -0.46629039, -0.47260231, -0.50416193, -0.5230977 ,
       -0.54834539, -0.57359308, -0.59252885, -0.62408847, -0.64933616,
       -0.68089578, -0.70614347, -0.73770309, -0.76295078, -0.78188655,
       -0.80713425, -0.83238194, -0.86394156, -0.89550117, -0.91443694,
       -0.92706079, -0.95230848, -0.9838681 , -1.01542771, -1.04698733,
       -1.05961118, -1.09117079, -1.12273041, -1.13535426, -1.16060195,
       -1.19216157, -1.21740926, -1.24896888, -1.27421657, -1.30577619,
       -1.33102388, -1.34995965]), 'timesteps': array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16,
       17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33,
       34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50,
       51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67,
       68, 69, 70, 71, 72, 73, 74, 75, 76], dtype=int32), 'user_group': 0}
Number of training trajectories: 16000
<src.data.dataset.RecommendationDataset object at 0x7f5444bba290>
  ✔ Checkpoint guardado: checkpoints/dt_epoch1_val6.6756.pt
Epoch 1/1000
  Train Loss: 6.6993
  Val   Loss: 6.6756
  ✔ Checkpoint guardado: checkpoints/dt_epoch11_val6.6376.pt
Epoch 11/1000
  Train Loss: 6.6172
  Val   Loss: 6.6376
Epoch 21/1000
  Train Loss: 6.3342
  Val   Loss: 6.7205
Epoch 31/1000
  Train Loss: 5.9339
  Val   Loss: 6.8591
Epoch 41/1000
  Train Loss: 5.4803
  Val   Loss: 7.0822
Epoch 51/1000
  Train Loss: 5.1002
  Val   Loss: 7.3594
Epoch 61/1000
  Train Loss: 4.8068
  Val   Loss: 7.6796
Epoch 71/1000
  Train Loss: 4.5872
  Val   Loss: 8.0285
Epoch 81/1000
  Train Loss: 4.3845
  Val   Loss: 8.3266
Epoch 91/1000
  Train Loss: 4.2204
  Val   Loss: 8.6996
Epoch 101/1000
  Train Loss: 4.0930
  Val   Loss: 8.9672
Epoch 111/1000
  Train Loss: 3.9672
  Val   Loss: 9.2629
Epoch 121/1000
  Train Loss: 3.8605
  Val   Loss: 9.5577
Epoch 131/1000
  Train Loss: 3.7583
  Val   Loss: 9.9032
Epoch 141/1000
  Train Loss: 3.6572
  Val   Loss: 10.1655
Epoch 151/1000
  Train Loss: 3.5786
  Val   Loss: 10.3373
Epoch 161/1000
  Train Loss: 3.5032
  Val   Loss: 10.6993
Epoch 171/1000
  Train Loss: 3.4104
  Val   Loss: 10.8679
Epoch 181/1000
  Train Loss: 3.3502
  Val   Loss: 11.1577
Epoch 191/1000
  Train Loss: 3.2982
  Val   Loss: 11.3487
Epoch 201/1000
  Train Loss: 3.2426
  Val   Loss: 11.5838
Epoch 211/1000
  Train Loss: 3.1715
  Val   Loss: 11.7565
Epoch 221/1000
  Train Loss: 3.1070
  Val   Loss: 11.9827
Epoch 231/1000
  Train Loss: 3.0826
  Val   Loss: 11.9502
Epoch 241/1000
  Train Loss: 3.0120
  Val   Loss: 12.2710
Epoch 251/1000
  Train Loss: 2.9652
  Val   Loss: 12.4051
Epoch 261/1000
  Train Loss: 2.9361
  Val   Loss: 12.5982
Epoch 271/1000
  Train Loss: 2.8797
  Val   Loss: 12.8382
Epoch 281/1000
  Train Loss: 2.8324
  Val   Loss: 13.0662
Epoch 291/1000
  Train Loss: 2.7908
  Val   Loss: 13.2609
Epoch 301/1000
  Train Loss: 2.7659
  Val   Loss: 13.3749
Epoch 311/1000
  Train Loss: 2.7146
  Val   Loss: 13.5177
Epoch 321/1000
  Train Loss: 2.6894
  Val   Loss: 13.7436
Epoch 331/1000
  Train Loss: 2.6546
  Val   Loss: 13.8526
Epoch 341/1000
  Train Loss: 2.6056
  Val   Loss: 14.1407
Epoch 351/1000
  Train Loss: 2.5715
  Val   Loss: 14.3682
Epoch 361/1000
  Train Loss: 2.5433
  Val   Loss: 14.4399
Epoch 371/1000
  Train Loss: 2.5198
  Val   Loss: 14.4966
Epoch 381/1000
  Train Loss: 2.4811
  Val   Loss: 14.6642
Epoch 391/1000
  Train Loss: 2.4638
  Val   Loss: 14.7869
Epoch 401/1000
  Train Loss: 2.4425
  Val   Loss: 15.1209
Epoch 411/1000
  Train Loss: 2.3929
  Val   Loss: 15.1664
Epoch 421/1000
  Train Loss: 2.3699
  Val   Loss: 15.4522
Epoch 431/1000
  Train Loss: 2.3452
  Val   Loss: 15.4378
Epoch 441/1000
  Train Loss: 2.3312
  Val   Loss: 15.7297
Epoch 451/1000
  Train Loss: 2.3145
  Val   Loss: 15.4918
Epoch 461/1000
  Train Loss: 2.3029
  Val   Loss: 15.8681
Epoch 471/1000
  Train Loss: 2.2631
  Val   Loss: 15.9314
Epoch 481/1000
  Train Loss: 2.2468
  Val   Loss: 16.0316
Epoch 491/1000
  Train Loss: 2.2139
  Val   Loss: 16.2179
Epoch 501/1000
  Train Loss: 2.1957
  Val   Loss: 16.3670
Epoch 511/1000
  Train Loss: 2.1959
  Val   Loss: 16.4265
Epoch 521/1000
  Train Loss: 2.1748
  Val   Loss: 16.4305
Epoch 531/1000
  Train Loss: 2.1563
  Val   Loss: 16.7839
Epoch 541/1000
  Train Loss: 2.1318
  Val   Loss: 16.6109
Epoch 551/1000
  Train Loss: 2.1248
  Val   Loss: 16.9358
Epoch 561/1000
  Train Loss: 2.0846
  Val   Loss: 16.9088
Epoch 571/1000
  Train Loss: 2.0755
  Val   Loss: 17.2009
Epoch 581/1000
  Train Loss: 2.0592
  Val   Loss: 17.4371
Epoch 591/1000
  Train Loss: 2.0525
  Val   Loss: 17.2707
Epoch 601/1000
  Train Loss: 2.0352
  Val   Loss: 17.2664
Epoch 611/1000
  Train Loss: 2.0129
  Val   Loss: 17.4227
Epoch 621/1000
  Train Loss: 1.9933
  Val   Loss: 17.4675
Epoch 631/1000
  Train Loss: 1.9776
  Val   Loss: 17.6971
Epoch 641/1000
  Train Loss: 1.9797
  Val   Loss: 17.7002
Epoch 651/1000
  Train Loss: 1.9642
  Val   Loss: 17.8889
Epoch 661/1000
  Train Loss: 1.9497
  Val   Loss: 17.7615
Epoch 671/1000
  Train Loss: 1.9329
  Val   Loss: 17.9790
Epoch 681/1000
  Train Loss: 1.9339
  Val   Loss: 18.1929
Epoch 691/1000
  Train Loss: 1.9074
  Val   Loss: 18.2479
Epoch 701/1000
  Train Loss: 1.9080
  Val   Loss: 18.2111
Epoch 711/1000
  Train Loss: 1.8816
  Val   Loss: 18.4439
Epoch 721/1000
  Train Loss: 1.8756
  Val   Loss: 18.3866
Epoch 731/1000
  Train Loss: 1.8585
  Val   Loss: 18.5369
Epoch 741/1000
  Train Loss: 1.8636
  Val   Loss: 18.4371
Epoch 751/1000
  Train Loss: 1.8464
  Val   Loss: 18.7660
Epoch 761/1000
  Train Loss: 1.8289
  Val   Loss: 18.8392
Epoch 771/1000
  Train Loss: 1.8429
  Val   Loss: 18.7621
Epoch 781/1000
  Train Loss: 1.8040
  Val   Loss: 18.8988
Epoch 791/1000
  Train Loss: 1.8146
  Val   Loss: 18.8814
Epoch 801/1000
  Train Loss: 1.7871
  Val   Loss: 19.1057
Epoch 811/1000
  Train Loss: 1.7756
  Val   Loss: 19.1553
Epoch 821/1000
  Train Loss: 1.7789
  Val   Loss: 19.0550
Epoch 831/1000
  Train Loss: 1.7624
  Val   Loss: 19.2088
Epoch 841/1000
  Train Loss: 1.7648
  Val   Loss: 19.1521
Epoch 851/1000
  Train Loss: 1.7564
  Val   Loss: 19.1686
Epoch 861/1000
  Train Loss: 1.7406
  Val   Loss: 19.4579
Epoch 871/1000
  Train Loss: 1.7402
  Val   Loss: 19.3654
Epoch 881/1000
  Train Loss: 1.7296
  Val   Loss: 19.6159
Epoch 891/1000
  Train Loss: 1.7098
  Val   Loss: 19.8050
Epoch 901/1000
  Train Loss: 1.7013
  Val   Loss: 19.3790
Epoch 911/1000
  Train Loss: 1.7014
  Val   Loss: 19.5677
Epoch 921/1000
  Train Loss: 1.6844
  Val   Loss: 19.7587
Epoch 931/1000
  Train Loss: 1.6793
  Val   Loss: 19.7234
Epoch 941/1000
  Train Loss: 1.6885
  Val   Loss: 20.0977
Epoch 951/1000
  Train Loss: 1.6787
  Val   Loss: 19.8700
Epoch 961/1000
  Train Loss: 1.6579
  Val   Loss: 20.1204
Epoch 971/1000
  Train Loss: 1.6571
  Val   Loss: 20.2851
Epoch 981/1000
  Train Loss: 1.6353
  Val   Loss: 20.2208
Epoch 991/1000
  Train Loss: 1.6222
  Val   Loss: 20.2661
Model saved to 'trained_model_2025-12-02_14-09-17.pt'
Training history saved to 'training_history_2025-12-02_14-09-17.pkl'
